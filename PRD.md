### 📄 V1 基础版产品需求文档 (PRD)

仓库名： jx3-photo-maker

**产品定位：** 一款纯浏览器的剑网三截图排版与打标签工具，主打“开箱即用的门派预设”和“零服务器隐私安全”。

#### 1. 核心用户主流程

用户打开网页 -> 点击/拖拽上传游戏截图 -> 自动适配画布 -> 点击右侧“门派预设”或“添加文字” -> 在画布上拖拽调整文字位置、大小、字体 -> 点击“导出保存”下载最终图片。

#### 2. 模块详细拆解

**模块一：画布与图片上传区 (Canvas Area)**

* **功能：**
* 支持本地图片上传（拖拽上传或点击选择文件）。
* 画布自适应：根据上传图片的宽高比，自动缩放画布显示完整图片（底图锁定，不可随意拖动，防止误触）。
* 空白状态提示：上传前的占位提示区（shadcn 的空状态组件）。



**模块二：操作控制台 (Toolbar / Sidebar)**

* **功能：** 提供所有编辑工具。
* **通用文本：** 添加普通文字框。
* **属性编辑面板（当选中画布上的文字时出现）：**
* 输入框：修改文字内容。
* 字体选择：下拉菜单切换内置古风字体。
* 颜色选择器：修改文字颜色（支持预设的门派主题色，如天策红 `#C41A16`，纯阳蓝 `#4788C7`）。
* 字号、粗细、透明度调节滑块（shadcn 的 Slider 组件）。
* 图层操作：上移一层、下移一层、删除。





**模块三：剑网三特色预设模块 (JX3 Presets)**

* **功能：** 极大地降低用户操作成本。
* **门派按钮组：** 展示各门派的 Icon 或名称。
* **交互：** 用户点击“万花”，画布中央自动生成一段带有万花专属紫色（如 `#B388FF`）和默认古风字体的文字（例如：“万花 - [在此输入ID]”）。



**模块四：导出与保存模块 (Export)**

* **功能：** 将合成后的 Canvas 画布导出。
* 支持导出为高清 PNG 或 JPG。
* 导出时应保持原图的实际分辨率，而不是浏览器里的缩放分辨率（关键体验点）。



---

### 🛠️ V1 详细技术选型方案

既然决定了方向，以下是为你量身定制的现代化前端技术栈：

#### 1. 基础框架与构建工具

* **核心框架：** `React 18`
* **构建工具：** `Vite`（极速启动，HMR 热更新体验极佳）
* **开发语言：** `TypeScript`（强烈建议，图片编辑器的对象属性极其繁杂，有 TS 类型提示能省去无数 Debug 的时间）

#### 2. UI 与样式层 (基于 shadcn)

* **UI 组件库：** `shadcn/ui`（提供极简、可定制的现代 UI，用于侧边栏、按钮、滑块、下拉菜单）。
* **CSS 框架：** `Tailwind CSS`（shadcn 的底层依赖，写布局和样式又快又爽）。
* **图标库：** `Lucide React`（shadcn 默认图标库，非常精美，用于删除、图层上下移等按钮）。

#### 3. 核心业务层 (画布与图片处理)

* **Canvas 引擎：** `Fabric.js`
* **理由：** 它是目前处理 2D 交互最成熟的库。原生支持 `fabric.Image` 和 `fabric.IText`。它把画布里的每一个文字、图片都当作独立的对象，自带选中框、拖拽、旋转缩放的控制点（Control points），这正是你需要的核心功能，如果用原生 Canvas API 手写这些控制点会让人崩溃。


* **状态管理：** `Zustand`
* **理由：** 你需要一个地方来存储“当前选中的门派是什么”、“当前画布上有哪些文本对象”、“当前被鼠标点中的是哪个字”。Zustand 非常轻量，无需像 Redux 那样写繁琐的样板代码，随时可以在非 React 组件（比如 Fabric 实例的回调中）读取和更新状态。



#### 4. 特殊技术点处理库

* **字体加载控制：** `fontfaceobserver`
* **痛点：** 浏览器加载外部字体是异步的，如果字体没下载完 Canvas 就把字画上去了，会导致字体不生效或者渲染成系统默认字体。
* **解法：** 使用这个库监听用户选择的字体，当字体下载完毕并解析成功后，再调用 `canvas.requestRenderAll()` 重新绘制。


* **颜色选择：** `react-colorful`
* **理由：** 一个极小、极快的拾色器组件，用于给文本自定义颜色。

